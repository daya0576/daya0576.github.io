---
title: "ä¸‡å…† nas diy æ­å»ºå°è®°ï¼ˆSynology -> Unraidï¼‰"
date: 2024-12-28T06:13:48+08:00
categories:
- æ™ºèƒ½å®¶å±…
---

è‡ªä»è´­ä¹°äº† Mac Mini M4 PRO, åšä¸»ä¾¿å¯é£Ÿéš¾å®‰ :(

åŸå› ç«Ÿæ˜¯é€‰é…äº†ã€Œä¸‡å…†ã€ç½‘å£ï¼Œå´æ— å¥ˆå®¶ä¸­é¢„é“ºçš„ç½‘çº¿ä¸ç¾¤æ™– DS220+ éƒ½å—é™**åƒå…†**ï¼Œç™½ç™½æµªè´¹ç€å®ä»¤äººç„¦è™‘ã€‚

è¿‘æ—¥æ›´æ˜¯è¢«ç¾¤æ™–ç¡¬ç›˜â€œç‚’è±†å­â€å£°éŸ³å›°æ‰°ï¼Œäºæ˜¯ä¾¿ç€æ‰‹æ‰“é€ ä¸€å°å¿ƒç›®ä¸­ç†æƒ³çš„ä¸‡å…† nas ğŸ¤©
1. æ‹’ç»å™ªéŸ³ï¼šå…¨å›ºæ€é˜µåˆ— or æœºæ¢°ç¡¬ç›˜ä¼‘çœ 
2. é«˜é€Ÿè¿æ¥ï¼šä¸‡å…† or é›·ç”µè¿æ¥
3. å¯æ‰©å±•æ€§ï¼šæ¨ªå‘æ— é™æ‰©å±•
4. ...

# TOC

- [æ”¹é€ è®¡åˆ’](#æ”¹é€ è®¡åˆ’)
- [ç¡¬ä»¶æ”¹é€ ](#ç¡¬ä»¶æ”¹é€ )
  - [HDD](#hdd)
  - [ä¸‡å…†ç½‘å¡](#ä¸‡å…†ç½‘å¡)
- [è½¯ä»¶æ­å»º](#è½¯ä»¶æ­å»º)
  - [Unraid](#unraid)
- [æœ€ç»ˆæ•ˆæœ](#æœ€ç»ˆæ•ˆæœ)
  - [ç¡¬ä»¶äº¤äº’](#ç¡¬ä»¶äº¤äº’)
  - [è½¯ä»¶äº¤äº’](#è½¯ä»¶äº¤äº’)
- [æ€»ç»“](#æ€»ç»“)


# æ”¹é€ è®¡åˆ’
åŸºäºä¸Šè¿°éœ€æ±‚ï¼Œå¸‚åœºä¸Šæœ‰ä¸å°‘ä¼˜ç§€çš„å…¨é—ªå­˜ nas äº§å“ï¼Œä¾‹å¦‚æ–°æ¨å‡ºçš„ [LincPlus N1](https://www.lincplustech.com/products/lincstation-n1-network-attached-storage)ï¼Œ[TERRA MASTER F8 SSD](https://www.terra-master.com/us/f8-ssd.html), éƒ½æ€§æ„Ÿçš„ä»¤äººå¿ƒåŠ¨ã€‚ä½†ä¸€ä½“åŒ–çš„è®¾è®¡ï¼Œåœ¨æ‰©å±•æ€§ä¸Šéšéšä»¤äººçŠ¹è±«ä¸æ‹…å¿§ã€‚

è½¬å¿µä¸€æƒ³ï¼Œæœ€ç»ˆå°†é­”çˆªç«Ÿä¼¸å‘äº†ä¸€å¹´å‰æ­å»ºçš„ PCï¼ˆ[FormD T1 V2.0 è£…æœºå°è®°](/blog/20230806/build-pc-formd-t1/)ï¼‰ä¸ Unraid ç³»ç»Ÿï¼š
1. æ‹’ç»å™ªéŸ³ï¼š
    - æœºæ¢°ç¡¬ç›˜æ— è®¿é—®è¶…æ—¶è‡ªåŠ¨ä¼‘çœ ï¼ˆspin down delayï¼‰-> è§£å†³ç‚’è±†å­å™ªéŸ³é—®é¢˜
    - å®šæœŸæˆ–æ ¹æ®è‡ªå®šä¹‰ç­–ç•¥ï¼Œæ·±å¤œè‡ªåŠ¨å°† ssd ç¼“å­˜æ± æ•°æ®ï¼Œå†™å…¥ hdd å†·å¤‡ï¼ˆ*ç¾å¦™çš„æ˜¯å¯¹äºå¤–éƒ¨å…±äº«è®¿é—®æ— æ„Ÿ*ï¼‰
2. é«˜é€Ÿè¿æ¥
    - æ–°å¢ä¸‡å…†ç½‘å¡ï¼Œé…åˆ ssd ç¼“å­˜æ± ï¼ˆUnraid Poolï¼‰ï¼Œä¸ Mac é«˜é€Ÿè¿æ¥
    - æœªæ¥å®˜æ–¹æ”¯æŒé›·ç”µåï¼Œè¿›ä¸€æ­¥æå‡ä¼ è¾“é€Ÿç‡
3. å¯æ‰©å±•æ€§
    - Unraid æ”¯æŒä¸åŒå®¹é‡ç¡¬ç›˜ç»„é˜µåˆ—ï¼Œçµæ´»æ–°å¢ç¡¬ç›˜ï¼ˆ*æ ¡éªŒç›˜çš„å®¹é‡å¿…é¡»æœ€å¤§*ï¼‰
4. ...

# ç¡¬ä»¶æ”¹é€ 
å½“åˆè´­ä¹°äº† formd t1ï¼Œç¬¬ä¸€çœ¼å°±è¢«å®ƒæ€§æ„Ÿçš„å¤–è§‚å¸å¼•ï¼Œä»¥åŠäº«å—åŠ¨æ‰‹ diy çš„è¿‡ç¨‹ã€‚ä¸åŒçš„è‡ªå®šä¹‰ç»„ä»¶ç›¸äº’æ‹¼å‡‘ï¼Œå°±å¦‚åŒç¼–ç¨‹ä¸­çš„â€œç»„åˆâ€ï¼Œä»¤äººå¿ƒæ—·ç¥æ€¡ã€‚

å¦‚ä»Šæœ‰äº†æ–°çš„ç”¨æˆ·éœ€æ±‚ï¼Œä¸å¦¨å¯¹å®ƒåšä¸€æ¬¡â€œé‡æ„â€ :)

## HDD
å¹¸è¿çš„æ˜¯ï¼Œä¸»æ¿ z690i ä¸Šæä¾›äº†å‰é¢æ¿ SATA æ‰©å±•å¡(åŒ…å« 4 ä¸ª SATA ç«¯å£)ã€‚

æ·˜å®å®šåˆ¶ç”µæºçº¿ä¸æ•°æ®çº¿åï¼Œä¾¿é¡ºåˆ©å°†ç¾¤æ™–ä¸­çš„ç¡¬ç›˜æ‹†å¸å¹¶æ¥å…¥ã€‚

![](/images/blog/2021-09-04-jvm-note/17353418708512.jpg)

## ä¸‡å…†ç½‘å¡
ä¸å¹¸çš„æ˜¯ï¼Œä¸»æ¿è‡ªå¸¦çš„ç½‘å¡åªæœ‰ 2.5Gbï¼Œè™½ç„¶å¯ä»¥è½»æ¾è·‘æ»¡æœºæ¢°ç¡¬ç›˜ï¼Œä½†åœ¨å›ºæ€ç¡¬ç›˜å‰æ˜¾å¾—æœ‰ä¸€ä¸ä¹åŠ›ã€‚

æ›´ä¸å¹¸çš„æ˜¯ï¼Œå”¯ä¸€çš„ PCIe x16 å¡æ§½å·²è¢«æ˜¾å¡å ç”¨ã€‚ä¸‡å¹¸çš„æ˜¯åœ¨æ·˜å®ä¸­ï¼Œæ‰¾åˆ°äº† *M2 è½¬ PCIe x4 çš„å»¶é•¿çº¿*ï¼Œå¯ä»¥å…¼å®¹å¤§éƒ¨åˆ†æ¶ˆè´¹çº§çš„ä¸‡å…†ç½‘å¡ã€‚

ä»¤äººåˆçˆ±åˆæ¨çš„ itx æœºç®±ï¼š

![IMG_2228](/images/blog/2021-09-04-jvm-note/IMG_2228.jpeg)

# è½¯ä»¶æ­å»º

## Unraid

æ ¹æ®å®˜æ–¹ [Getting Started](https://unraid.net/getting-started) æ–‡æ¡£ï¼Œåˆ¶ä½œå¯åŠ¨ç›˜å¹¶è¿›å…¥ç³»ç»Ÿå³å¯ã€‚

Un-raid é¡¾åæ€ä¹‰ï¼Œå³â€œé-RAIDâ€ï¼šä¸åŒäº raid5 ç”šè‡³ raid1ï¼Œä»…åˆ©ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªæ ¡éªŒç›˜å®ç°çš„æ•°æ®å†—ä½™ï¼ˆ[å®˜æ–¹æ–‡æ¡£](https://docs.unraid.net/unraid-os/overview/nas/#parity-protected-array)ï¼‰ã€‚

![](/images/blog/2021-09-04-jvm-note/17353543537707.jpg)

æ€»è€Œè¨€ä¹‹ï¼Œè¶Šæ˜¯ç®€å•å®¹æ˜“ç†è§£çš„æ–¹æ¡ˆï¼Œä¸ªäººè¶Šæ˜¯æ›´åŠ å–œæ¬¢ï½

> Simple is better than complex.

## ç¼˜åˆ†

æ›´ä¸ºå¥‡å¦™çš„æ˜¯ï¼Œå®‰è£…å®Œ Unraid å¹¶æ‰“å¼€åº”ç”¨å•†åº—çš„ä¸€åˆ»ã€‚é¦–é¡µæœ€æ–°åŠ å…¥çš„åº”ç”¨ç«Ÿç„¶æ˜¯æˆ‘å¼€å‘ [Beaver Habit Tracker](https://github.com/daya0576/beaverhabits)ï¼ˆæ„Ÿè°¢å¥½å¿ƒäººâ˜ºï¸ï¼‰ï¼š

![](/images/blog/2021-09-04-jvm-note/17353556762017.jpg)

ç¼˜åˆ†å¦™ä¸å¯è¨€ï½

# æœ€ç»ˆæ•ˆæœ
## ç¡¬ä»¶äº¤äº’

ä¸‡å…†é“¾è·¯ï¼š
```
// FormD T1
- ROG STRIX Z690-I 
- M.2 NVMe to PCIe x4 Extension Cable (ADT-Link M42UF)
- 10G PCIe NIC (TL-NT521 - AQC107)

// Switch
- 10G DAC Cable (XikeStor)
- 10G Switch (XikeStor)
- 10G SFP+ to RJ45 Module (XikeStor)

// Mac Mini
- 10 Gigabit Ethernet Port
```

ç®€å•æ”¶çº³åæ•ˆæœä¼¼ä¹è¿˜ä¸é”™å“Ÿï¼š

![37D5AA00-87F9-42FC-9705-E31F21A585A2](/images/blog/2021-09-04-jvm-note/37D5AA00-87F9-42FC-9705-E31F21A585A2.jpeg)

![BA2D1CB7-FE36-4151-8C90-8123C4533ABC](/images/blog/2021-09-04-jvm-note/BA2D1CB7-FE36-4151-8C90-8123C4533ABC.jpeg)


## è½¯ä»¶äº¤äº’

![unraid](/images/blog/2021-09-04-jvm-note/unraid.png)

å¾…å¡«æ»¡çš„ Pool & Array æ± ï¼š

![](/images/blog/2021-09-04-jvm-note/17353574826432.jpg)


æ­é… Infuse ç®¡ç†ç”µå½±ä¸ä¸ªäººè§†é¢‘ï¼š

![](/images/blog/2021-09-04-jvm-note/17353453778902.jpg)

# æ€»ç»“
Unraid ç³»ç»Ÿå‡ ä¹æ¯ä¸ªç‰¹æ€§ï¼Œéƒ½å‡»ä¸­åœ¨åšä¸»çš„å¿ƒè¶´ä¸Šã€‚æœŸå¾…æœªæ¥å‡ å¤©ç»§ç»­æ¢ç´¢æ›´å¤šåŠŸèƒ½ï¼š

- [ ] é›·ç”µ4 ç›´è¿ï¼ˆå®˜æ–¹æš‚ä¸æ”¯æŒ thunderbolt bridgeï¼Œä½†ç†è®ºä¸Šå¯è¡Œï¼‰
- [x] æ­é… Mover Tuning è‡ªå®šä¹‰ç¼“å­˜æ± ç§»åŠ¨é€»è¾‘ï¼ˆä¾‹å¦‚æ ¹æ®æ—¥æœŸæ–‡ä»¶å¤§å°ç­‰ï¼‰
- [x] è™šæ‹ŸåŒ–æ¸¸æˆä½“éªŒ
- [x] ç½‘å¤–è¿æ¥ï¼šç®€å•é€šè¿‡ cloudflare tunnel å³å¯å®ç°
- ...


# å…¶ä»–
## Mover Tuning è®¾ç½®
ä»¥å¤§ç–†æ‹æ‘„çš„ä¹’ä¹“çƒè§†é¢‘å·¥ä½œæµä¸ºä¾‹ï¼š

1. [Cache] å°†å½“æ—¥ä¹’ä¹“çƒå½•åˆ¶è§†é¢‘å¯¼å…¥
2. [Cache] å›é¡¾ä¸è§†é¢‘å‰ªè¾‘
3. [Array] æ¯æ—¥å‡Œæ™¨ä¸¤ç‚¹å®šåˆ¶æ‰«æï¼Œè‹¥æ»¡è¶³ä¸‹é¢çš„æ¡ä»¶ï¼Œåˆ™ç§»åŠ¨è‡³å†·å¤‡
    - è§†é¢‘è¶…è¿‡ 15 å¤©
    - æ–‡ä»¶å¤§äº 10M

![](/images/blog/global/17356894814590.jpg)


## è™šæ‹ŸåŒ–æ¸¸æˆä½“éªŒ
step by step tutorial to enable GPU passthrough: 
<iframe width="560" height="315" src="https://www.youtube.com/embed/nTZ1Whx3cZo?si=Xa0M5en81hF6pwL6" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

è™½ç„¶é‡åˆ°äº†æ˜¾å¡æ— æ³• passthrough æ˜¾ç¤ºå™¨æ— æ³•ç‚¹äº®çš„é—®é¢˜ï¼Œä½†ä¸‡å¹¸æœ€ç»ˆé€šè¿‡å‡çº§ bois ç‰ˆæœ¬è§£å†³äº†ã€‚


## é¿å…å¿…é¡»è¦é”®ç›˜è¿æ¥æ‰èƒ½å¯åŠ¨

å°è¯•äº†å¾ˆå¤š bois è®¾ç½®æ— æœï¼Œæœ€ç»ˆå¤Ÿä¹°äº†é”®ç›˜é•¿æœŸç›´è¿ã€‚

1. https://www.truenas.com/community/threads/motherboards-that-boot-automatically-from-usb-without-pressing-f8-or-so-solved.11672/

## ç”µæµæ»‹æ»‹å£°

èµ·åˆæ€€ç–‘ä¸º GPU å•¸å«âš¡ï¸

ç„¶è€Œå®‰è£…æ’ä»¶åï¼Œè™½ç„¶ GPU è®¾ç½®ä¸º p8 èŠ‚èƒ½æ¨¡å¼ï¼Œä½†ç”µæµå£°ä¾ç„¶æœªç¼“è§£ï¼š
![](/images/blog/global/17359155365436.jpg)

æ•…å°†ä¸»æœºä¸Šçš„è®¾å¤‡ä¸€ä¸€ç§»é™¤ï¼Œæœ€ç»ˆå‘ç°ç–‘ä¼¼ CPU äº§ç”Ÿçš„å™ªéŸ³ã€‚

è¿™æ—¶ä¸€æ¡å…³é”®çš„çº¿ç´¢æµ®å‡ºæ°´é¢ï¼šå½“åœ¨ä¸»æœºæ‰§è¡Œ stress test è·‘æ»¡è´Ÿè½½æ—¶ï¼ˆç›¸æ¯”äº low load ä½è´Ÿè½½ï¼‰ï¼Œå™ªéŸ³ç«Ÿç„¶æ¶ˆå¤±äº†ã€‚è‡³å°‘å¯ä»¥ç¡®è®¤ cpu å¯¼è‡´çš„é—®é¢˜ã€‚

æœ€ç»ˆåœ¨ asus bois è®¾ç½®ä¸­ä¸€é¡¿æ“ä½œï¼Œç»ˆäºæ¶ˆç­äº†ç”µæµå£°å™ªéŸ³ï¼š
```
CPU C-states [Auto]->[Disabled]
Acoustic Noise Mitigation [Disabled]->[Enabled] // å…³é”®
```

