var MBOX=DP.mbox,group_intro_prompt,page=page||{};window.addEvent("domready",function(){group_intro_prompt=new Prompt});
function MBOX_openLite(a,c,b){MBOX.close();MBOX.open({winCls:"pop-win",closable:!1,size:c||{x:"auto",y:"auto"},url:MBOX.dialog(null,'<div class="comment-form" id="J_pop_form"><div class="form-block" style="text-align:center">'+a+(b?'<a href="javascript:;" onclick="MBOX.close();" class="close-txt">[关闭]</a>':"")+"</div></div>")});$("J_pop_form").getParent().setStyles({margin:0,padding:0})}
function MBOX_confirm(a,c,b,d){MBOX.close();MBOX.open({winCls:"pop-win",url:MBOX.dialog(a,'<div class="pop-msg-wrapper"><p>'+c+'</p><div class="pop-btn-wrapper"><span class="btn-type-a btn-fn-a"><a class="form-btn" href="javascript:;" id="J_pop_ok">确定</a></span><span class="btn-type-a btn-fn-b"><a class="form-btn" href="javascript:;" id="J_pop_cancel">取消</a></span></div></div>'),size:d||{x:300,y:160}});$("J_pop_ok").addEvent("click",function(a){a.stop();try{b()}catch(d){}});$("J_pop_cancel").addEvent("click",
function(b){b.stop();MBOX.close()})}function BindPlaceHolder(a){var c=a.get("placeholder");a.value=c;a.addEvents({focus:function(){a.get("value").trim()==c&&a.set("value","");a.removeClass("form-default")},blur:function(){0===a.get("value").trim().length&&a.set("value",c);a.get("value").trim()==c&&a.addClass("form-default")}})}function refreshPage(){var a=location.href;location="#"===a.slice(-1)?a.slice(0,-1):a}
function ListMoreOrLess(a){if(a){var c=a.getElements(".Hide"),b=a.getElement(".fn-more a");b&&(_state=b.$show,b.addEvent("click",function(a){a.stop();c.toggleClass("Hide");b.set("html",_state?"显示更多":"收起更多");_state=!_state}))}}
page&&Object.merge(page,{nav:function(){var a=page.categoryName,c,b=$$(".b-nav .nav-list .nav-item"),d=$$(".b-nav .nav-list .pop-panel"),e=b.length;b.each(function(f,g){var i=e-g-1;f.addEvents({mouseover:function(a){var f=this.getElement("ul");a&&a.stop();b.removeClass("this");this.addClass("this");d.setStyles({visibility:"hidden"});f.setStyles({visibility:"visible"});if(!this.$counted){var h=f.getElements("li").length,j=0,a=0==g&&0!=i?7:20;3>=e&&5<h&&(a=7);h>g+2?(h=(c=$$(".b-nav")[0])?c.getPosition().y:
180,j=h-f.getPosition().y+a):h>i&&(j=20*(i-h+1));f.setStyle("top",j);this.$counted=!0}}});f.getElement("span").get("text")==a&&f.fireEvent("mouseover")})},search:function(a){var c=$("J_search_p"),b=$("J_search_value"),d=$("J_search_select"),e=b?b.get("placeholder")||"":"";c&&c.addEvent("click",function(){var a=b.value.trim()==e?"":b.value.trim().cnEncode();0===a.length?MBOX_openLite("请输入关键字   ",{x:155},!0):location.href="/"+page.perma+"/search/"+d.get("value")+"_"+a});b&&b.addEvents({keydown:function(a){13===
a.code&&(a.stop(),c.fireEvent("click"))}});!a&&b&&BindPlaceHolder(b)},moreOrLess:function(){var a=$("J_summary_more"),c=a&&a.getParent().getElement("span");a&&a.addEvent("click",function(b){b.stop();"less"==a.className?(a.removeClass("less").addClass("more").setProperty("title","更多").set("html","更多"),c.addClass("Hide")):(a.removeClass("more").addClass("less").setProperty("title","收起").set("html","收起"),c.removeClass("Hide"))})},activeList:function(){var a=$$("#J_active_op li"),c=$$("#J_active_list ul");
a.addEvent("click",function(b){b.stop();a.toggleClass("active");c.toggleClass("Hide")})},pageGo:function(){var a=$$(".J_pageGo"),c=/^[1-9][0-9]*$/;a.length&&a.forEach(function(a){var d=a.getElement(".J_pageBtn"),e=a.getElement(".J_pageError"),f=a.getElement(".J_pageInput");d.addEvent("click",function(a){a.stop();(a=f.get("value"))&&c.test(a)?parseInt(a)<=DP.data("pageCount")?(window.location.href="?pageno="+a,e.addClass("Hide")):e.removeClass("Hide"):e.removeClass("Hide")})})}});
function imgLazyload(){var a=$(window),c=new new Class({initialize:function(b){var d=this,b=b||{};d.arr=[];d.range=b.range||50;d.elements=b.config||["img"];d.containers=b.containers||[document];d._loadElement=function(){d.loadElement.call(d)};a.addEvent({scroll:d._loadElement,resize:d._loadElement});d._init();d._load()},_init:function(){var a,d,c,f,g,i,k,l,h=this.elements,j=this.containers;a=0;for(d=j.length;a<d;a+=1){c=0;for(f=h.length;c<f;c+=1){k=j[a].getElementsByTagName(h[c]);g=0;for(i=k.length;g<
i;g+=1)(l=k[g].getAttribute("data-lazyload"))&&k[g].src!=l&&this.arr.push(k[g])}}},_load:function(){var b=this;b.timer=setTimeout(function(){b._loadElement();0===b.arr.length?(a.removeEvent("scroll",b._loadElement),a.removeEvent("resize",b._loadElement),clearTimeout(b.timer),delete b.timer):b._load()},1E3)},loadElement:function(){var b,c=this.range+a.getScroll().y+a.getSize().y,e,f,g=[],i=this.arr;for(b=0;e=i[b++];)if($(e).getPosition().y<=c){if((f=e.getAttribute("data-lazyload"))&&e.src!=f)e.src=
f.toLowerCase(),e.removeAttribute("data-lazyload")}else g.push(e);this.arr=g},loadRest:function(){var a,c,e,f=this.arr;for(a=0;c=f[a++];)if((e=c.getAttribute("data-lazyload"))&&c.src!=e)c.src=e.toLowerCase(),c.removeAttribute("data-lazyload");this.arr.length=0}})({range:700});window.addEvent("load",function(){setTimeout(function(){c.loadRest()},1E4)})}
window.addEvent("domready",function(){var a=$("J_offline_events");a&&a.getElement("ul").getElements("li").addEvent("mouseenter",function(a){a.stop();this.addClass("current").getSiblings("li").removeClass("current")})});
