---
title: [WIP] 新家全屋智能灯实践分享
tags: []
---

去年末交房后，虽然是精装交付，但按耐不住个人爱折腾的心，几乎将绝大部分的灯都换了一遍。当然在满足个人需求的过程中也踩了不少坑，春季假期写一篇博客纪念一下，如果刚好帮到你那就更好啦～

p.s. 见标题本文为整体设计思路，待整体安装完毕结束+体验一段时间后完结。

<!--more-->

# 一、名词解释

刚开始听到「单开双控」、「双开单控」的时候，我也是一脸懵逼，所以先简单介绍几个名词：

| 名词 | 含义 |
|---|---|
| 墙壁开关 | 家用墙壁开关一般由两部分组成：面板+暗盒底座。因为基本都是国家标准86型，所以将传统开关更换为无线开关无需更换传统暗盒。 |
| 单开 vs 双开 | 顾名思义双开指一个开关面板上有2个开关，甚至有三个开关的三控 |
| 单控 vs 双控 | 双控指两个开关面板可以同步控制一个灯，即在开关A关闭灯1，然后在开关B打开灯1 |

p.s. 单控与双控背后的实现非常巧妙，忍不住简单补充一下。

下图中左边👈为关灯状态，此时无论控制开关1还是开关2，灯都会从关闭 -> 开启（实现状态的同步）：

![双控](/images/blog/%E5%8F%8C%E6%8E%A7.svg)


# 二、个人需求
精装交付后所有灯具如下（忽略粗糙的户型图😂）：
![original](/images/blog/original.svg)

简单罗列日常需求：
1. 普通级（HomeKit 自动场景）：
    - 每日落日自动开启客餐厅的灯
    - 每日深夜自动关灯
    - 无线开关随手控制灯开启/关闭卧室的灯
    - ...
2. 升级版（个人的 biantai 需求）：
    - 开门后自动开灯（门厅四个筒灯延迟**逐个打开**）
    - 夜晚射灯感应活动开启（智能+自动调光）
    - ...

补充一下：
1. 为什么选择 HomeKit？一方面当然是相信苹果封闭生态把控的良好体验，另一方面因为家人用的苹果手机，并且暂时没有更换智能锁的计划，所以只有 HomeKit 可以实现前置条件：当有人在家的时候 -> 触发 xxx 自动化场景。

# 三、技术需求：

简单分析上面的个人需求后，我们可以发现背后隐含的技术需求：**在一个生态中（HomeKit），通过改造传统灯与开关，实现自动控制家内的每个灯。**

## 2.1 场景分类

这时聪明的你可能发现“改造传统灯与开关”没有那么简单，会衍生出多种组合：传统灯+智能开关、智能灯+传统开关、智能灯+智能开关。甚至会出现有多对多的情况：（智能灯+传统灯）+传统/智能开关？？ 

这也是最容易踩坑的地方，下面将结合实际的场景，详细介绍博主的心路历程～

### 1) 单开单控 - 主卧/次卧/书房

先从最简单的卧室说起（单开单控），这时摆在我面前的有两个选择：仅更换传统开关 or 传统灯升级智能灯

前者成本更低，但缺点为丢失了智能灯的功能性，例如色温调节，夜灯模式等。后者体验更佳，但墙壁开关沦为了摆设，甚至不小心关闭后，智能灯就完全“离线断联”了。。

正当纠结时，yeelight 的凌动开关映入我的眼帘，「凌动开关」本质上并非无线智能开关，而是通过触碰时物理的电流脉冲，i.e. 瞬间的断电，从而控制智能灯的状态（所以原生支持双控）。

**最终卧室采用了易来 光璨吸顶灯+凌动开关 的方案**，使用一个月后，配合床边 aqara无线按钮（单按开/关，双击切换至夜灯模式，摇一摇切换为日光模式），体验非常丝滑～

![bedroon_switch](/images/blog/bedroon_switch.svg)


### 2) 三开三控 - 厨房

厨房不大但自带了一堆筒灯射灯与一个三开开关，由于这时博主对于智能家居的热情已经从 200% 降低至 50% XD，所以选择的方案为：**仅替换传统开关为无线开关**，从而达到通过手机控制灯的目的。

个人认为，智能灯最终极的体验：让用户忘记开关的存在。所以在厨房中配合使用人体传感器，1）光线暗+有人进入厨房，自动开灯 2）当传感器持续15分钟检测到无人，自动关灯。

真的很香，谁用谁知道😋 

![kitchen_switch](/images/blog/kitchen_switch.svg)


### 3) 三开单控 - 厕所

上面罗列了两种最常见的改造方式（智能灯+凌动开关 / 传统灯+智能开关），但现实状况往往更加复杂..

比如我们的厕所，上个月师傅在安装浴霸时，半天没有找到电源，最终只能将浴霸与厕所的筒灯串联。也就是说如果关闭筒灯的开关，浴霸就断电进入离线状态无法再用遥控器控制 0.0

这时显然无法简单采用“传统灯+智能开关”的解决方案，但 **aqara 墙壁开关支持转无线**，这样就可以保持物理开关通电，按键无线控制灯开关的同时保持浴霸在线。但是注意！！**转成无线开关后，在 HomeKit 里面无法生效**，只能是在米家或者 Aqara home 绑定后置动作。

![bathroom_switch](/images/blog/bathroom_switch.svg)


### 4) 三开双控 - 客餐厅

终于到了最复杂的双控环节，但还不是最难的... 还记得开头博主的 biantai 需求吗：开门后四个筒灯依次延迟打开（回家的仪式感），所以重金购入四个智能筒灯，但是很遗憾客厅的灯已经替换为宜家的吸顶灯（带遥控非智能）。面对 智能灯+传统灯+双控开关 的现实，逐步融化.. 

（图）

先来罗列双控的常见解决方案：
1. **凌动墙壁开关**：因为永远通电，不难理解原生支持双控。但因为有传统灯具的存在，pass..
2. **智能墙壁开关 + 无线开关**：假如有双控开关（A+B），设置开关 A1 打开时同步 B1 开灯，A1 关闭时同步 B1 灯关，B1 设置同理。理论上可行，但总觉得不够优雅，同时对无线开关的稳定性存疑，pass...
3. **小燕多联多控**：小燕智能家居提供的集成方案，但很可惜需要再购买一个昂贵的网关..暂时放弃。

解决方案候选：
1. Aqara 面板S1：https://item.jd.com/100024962428.html
2. 小米无线开关（支持转无线）：https://jdcs.jd.com/index.action?_t=&pid=100010482809


## 2.2 容灾

HomeKit 完全基于局域网，但小米的设备还是基于服务器端的通信，如果有一天我的树莓派 HA 抽风，

## 四 总结

这篇博客简单介绍折腾智能灯的心路历程，最后分享一点个人感悟：

1. **专业的事让专业的人做**：虽然精装交付，但小小的改造却耗费个人精力，怪不得有一句话说如果没经历过装修不是完整的人生。在“装修”过程中，感悟出的一句话即“专业的事让专业的人做”。如果再给我一次机会进行全屋灯光改造，我可能更倾向于选择 aqara 或者 米家的全屋灯改造解决方案。
2. **不要过于迷信 HomeKit**：选用 HomeKit 还一个重要原因希望设备大一统，即使用米家开关控制 aqara 窗帘设备。但是后来购入米家的蓝牙Mesh网关后，它可以同时接入米家设备以及 aqara 的 Zigbee 设备，所以现在家里凭空闲置了多个 aqara 的昂贵网关。
3. **有线永远比无线稳定**：
5. **用户体验**：手机手动操作 > 声音控制 > 物理实体开关 > 无感，个人认为智能灯最终极的体验为让用户忘记开关的存在，尽可能使用人体感应、自适应灯光等辅助手段，来达到这个目的。
6. **历史包袱**：客厅双控的窘境，本质上更多的是因为自己选择了一款宜家的吸顶灯，导致智能灯与传统灯