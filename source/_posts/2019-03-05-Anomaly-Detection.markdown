---
title: æ­£æ€åˆ†å¸ƒ(Normal Distribution)å­¦ä¹ å°è®°
date: 2019-03-05 22:36:56
tags:
---


Coursera ä¸Šå´æ©è¾¾çš„[ã€Šæœºå™¨å­¦ä¹ ã€‹](https://www.coursera.org/learn/machine-learning/home/welcome)ç»ˆäºå­¦åˆ°äº†ç¬¬ä¹å‘¨çš„è¯¾ç¨‹. è¿™å‘¨ä¸ŠåŠéƒ¨åˆ†è®²è¿°äº† Anomaly Detection, å› ä¸ºå’Œå·¥ä½œæ¯”è¾ƒç›¸å…³([ç›‘æ§æŠ¥è­¦çš„æ™ºèƒ½é™å™ª](/blog/20190113/anomaly-detection/)), æ‰€ä»¥æ¯”è¾ƒæ„Ÿå…´è¶£ä¹Ÿå¾ˆæœŸå¾…! ç„¶è€Œçœ‹å®Œè§†é¢‘å, è¯´å®è¯ç•¥æœ‰äº›å¤±æœ›, å› ä¸ºåªä»‹ç»äº†æ­£æ€åˆ†å¸ƒè¿™ä¸€ç§ç®—æ³•. ä½†è§†é¢‘å’Œè¯¾åä½œä¸šå¸¦æˆ‘ä»å„ç§ä¸åŒè§’åº¦å‰–æäº†ä¸€éæ­£æ€åˆ†å¸ƒ, æ”¶è·é¢‡å¤š~         

æœ¬æ–‡ä¸»è¦è®°å½•äº†å®Œæˆ**è¯¾åç¼–ç¨‹ä½œä¸š**çš„è¿‡ç¨‹, å¹¶ç”¨pythonå®ç°ä¸€é(è¯¾ç¨‹ä¸ºmatlab), talk is cheap, show me the code. ä¹Ÿå¸Œæœ›è‡ªå·±ä¹ŸåŒ…æ‹¬æ­£åœ¨è¯»è¿™ç¯‡æ–‡ç« çš„ä½ , å¯ä»¥å¯¹æ­£æ€åˆ†å¸ƒæœ‰æ›´æ·±çš„ç†è§£. 

> In this exercise, you will implement the anomaly detection algorithm and apply it to detect failing servers on a network.

æ£€æµ‹æœåŠ¡å™¨æ˜¯å¦å¼‚å¸¸, å…´å¥‹ğŸ¥°

<!--more-->

# è¯¾åç¼–ç¨‹ä½œä¸š:
## 1. åŠ è½½æ•°æ®:
> You suspect that the vast majority of these examples are 'normal' (non-anomalous) examples of the servers operating normally, but there might also be some examples of servers acting anomalously within this dataset.

åˆ©ç”¨æ­£æ€åˆ†å¸ƒæ£€æµ‹å¼‚å¸¸, å…¶å®æ˜¯æœ‰ä¸€ä¸ªå‰æçš„, å°±æ˜¯æ•°æ®é›†ä¸­å¤§éƒ¨åˆ†çš„æ•°æ®éƒ½æ˜¯"æ­£å¸¸"çš„. å°†æŒ‡å®šçš„æ•°æ®é›†å¯è§†åŒ–å, å¯ä»¥æ˜æ˜¾çš„çœ‹åˆ°æœ‰å‡ ä¸ªç‚¹å­¤é›¶é›¶çš„åˆ†å¸ƒåœ¨å¼‚å¸¸çš„ä½ç½®.    
![](/images/blog/190302_cousera_anomaly_detection/15516041918813.jpg)

## 2.1 é«˜æ–¯åˆ†å¸ƒæ¨¡å‹ä»‹ç»
æœ‰äº†æ•°æ®, ç¬¬äºŒæ­¥å°±æ˜¯ç”¨è¿™äº›æ•°æ®å»ºç«‹ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒçš„æ¨¡å‹: ä¸‹å›¾ä¸­çš„å…¬å¼ `P(x;Î¼,Ïƒ^2)`, ä»£è¡¨ç»™å®šä¸€ä¸ªç‚¹(x), è¿”å›å®ƒåœ¨æ•´ä¸ªåˆ†å¸ƒä¸­çš„å…·ä½“æ¦‚ç‡:   
![](/images/blog/190302_cousera_anomaly_detection/model.jpg)


## 2.2 æ¨¡å‹å‚æ•°è®¡ç®—
è®¡ç®—é«˜æ–¯åˆ†å¸ƒæ¨¡å‹çš„ä¸¤ä¸ªå…³é”®å‚æ•°: 

1. Î¼(mean): å¹³å‡å€¼, è¯»ä½œmu
2. Ïƒ^2(variance): æ–¹å·®

å¯è§†åŒ–ä¹‹å, å¹¶å¯ä»¥çœ‹åˆ°å¤§éƒ¨åˆ†çš„ç‚¹é›†ä¸­åœ¨æœ€ä¸­å¿ƒé»„è‰²çš„åœ†åœˆ, å¹¶ä¸”åˆšåˆšè®¡ç®—çš„å¹³å‡å€¼å’Œåå·®å†³å®šäº†åœ†åœˆçš„å½¢çŠ¶å’Œå¤§å°. p.s. ä½†çœ‹äº†åŠå¤©æ²¡æ˜ç™½å…·ä½“æ¯ä¸ªåœˆå…·ä½“ä»£è¡¨ä»€ä¹ˆ, æ±‚æŒ‡ç‚¹.   
![](/images/blog/190302_cousera_anomaly_detection/15516064266294.jpg)

## 2.3 é€‰æ‹©é˜ˆå€¼
å®Œæˆé«˜æ–¯åˆ†å¸ƒæ¨¡å‹çš„å‚æ•°ä¹‹å, å¯ä»¥æ ¹æ®å…¬å¼è®¡ç®—å‡ºæ¯ä¸ªç‚¹åœ¨æ•°æ®é›†ä¸­çš„æ¦‚ç‡(è¶Šè¾¹ç¼˜çš„ç‚¹æ¦‚ç‡è¶Šä½, i.e. æ¦‚ç‡è¶Šä½, è¶Šå¯èƒ½æ˜¯ä¸ªå¼‚å¸¸). åœ¨è¿™ä¸€å°èŠ‚æˆ‘ä»¬å°±æ˜¯è¦æ‰¾åˆ°ä¸€ä¸ªç‰¹å®šçš„é˜ˆå€¼(Îµ), å¦‚æœæŸä¸ªç‚¹çš„æ¦‚ç‡åœ¨è¿™ä¸ªé˜ˆå€¼ä»¥ä¸‹, `p(x) < Îµ`, å³å¯åˆ¤æ–­ä¸ºå¼‚å¸¸!   
![](/images/blog/190302_cousera_anomaly_detection/15516075882385.jpg)

å¾ˆç¥å¥‡, ä½œä¸šä¸­æ˜¯åˆ©ç”¨ f1 score æ¥æ‰¾åˆ°æœ€åˆé€‚çš„é˜ˆå€¼(ä¹‹å‰å†™è¿‡[å¼‚å¸¸æ£€æµ‹çš„precision, recallå’Œf1 scoreçš„ä»‹ç»](/blog/20190113/anomaly-detection/#2-å›å½’æµ‹è¯•), æ„Ÿå…´è¶£å¯ä»¥çœ‹ä¸€ä¸‹). 

å¤§è‡´è¿‡ç¨‹æ˜¯æ ¹æ®æœ€å¤§å’Œæœ€å°æ¦‚ç‡å¾—åˆ°çš„é—´éš”, ä¸æ–­åœ°å°è¯•ä¸€åƒä¸ªä¸åŒçš„é˜ˆå€¼: `stepsize = (max(pval) - min(pval)) / 1000;`, æœ€åè®¡ç®—å¾—åˆ° f1 score æœ€å¤§çš„é‚£ä¸ªé˜ˆå€¼å°±æ˜¯æœ€ä¼˜è§£.    

ä½†åˆšåˆšä¸€ç›´å¾ˆç–‘æƒ‘ğŸ¤”: ç»™å®šä¸€ä¸ªé˜ˆå€¼, å¦‚ä½•è®¡ç®—å“ªäº›ç‚¹æ˜¯tp(true positive: the number of true positives: the ground truth label says it's an anomaly and our algorithm correctly classified it as an anomaly.), å› ä¸ºè¦ä¾èµ–äººå·¥æ ‡è®°çš„ ground truth. å¥½å§, å’Œæ€€ç–‘çš„ä¸€æ ·, ä¼ å…¥äº†äººå·¥æ ‡è®°å¥½çš„ cross validation set.   

# Pythonå®ç°
[è¦æ˜¯ä¸Šè¾¹æœ‰æ²¡çœ‹æ‡‚çš„åœ°æ–¹, æ²¡å…³ç³», ç‚¹æˆ‘æ¥ç›´æ¥çœ‹ä»£ç å§!](http://localhost:63343/normal_distribution_demo/normalization.html?_ijt=qjm1k3uhlise5vek8b664icc4r)   
ä½†åœ¨è®¡ç®—å‡ºå¤šä¸ª feature çš„"æ¦‚ç‡"ä¹‹åå°±å¡ä½äº†, å› ä¸ºä¸€ä¸ªç‚¹å¦‚æœæœ‰ä¸¤ä¸ª features, å°±ä¼šæœ‰ä¸¤ä¸ªæ¦‚ç‡, å¦‚ä½•åˆå¹¶ä¸ºä¸€ä¸ªå‘¢?  
![](/images/blog/190302_cousera_anomaly_detection/15517965144087.jpg)

## é¢†æ‚Ÿåˆ°çš„:
Q: ä¸ºä»€ä¹ˆæœ€å¤§çš„æ¦‚ç‡ä¸æ˜¯100%ï¼Ÿä¸Šé¢è¯´åˆ°æ¦‚ç‡çš„æ—¶å€™åŠ äº†yin hao
A: å› ä¸ºæ­£æ€åˆ†å¸ƒçš„æ•´ä½“çš„**ç§¯åˆ†é¢ç§¯**ä¸º1ï¼Œåªä¸è¿‡å®½çª„é«˜ä½ä¸åŒç½¢äº†ï¼Œæ‰€ä»¥yè½´å¹¶ä¸ä»£è¡¨æ¦‚ç‡ï¼Œæœ€å¤§å€¼ä¹Ÿå°±ä¸æ˜¯ 100%


# æ€è€ƒ & æ”¶è·
1. åœ¨æœºå™¨å­¦ä¹ çš„è¯¾ç¨‹ä¸­, å¤§éƒ¨åˆ†æƒ…å†µä¸‹, æ›´å¤šçš„æ˜¯å¼ºè°ƒå¦‚ä½•é€‰å–æœ‰æ•ˆçš„ç‰¹å¾, å¹¶åŒæ—¶ä½¿ç”¨å¤šä¸ªç‰¹å¾å»åšé¢„æµ‹. è€Œç°å®ä¸­, æˆ‘ä»¬å¸¸å¸¸åªè€ƒè™‘äº†ä¸€ç»´çš„ç‰¹å¾, ä¾‹å¦‚å¯¹äºä¸€ä¸ª spm ç›‘æ§(è¯·æ±‚é‡, æˆåŠŸé‡, æˆåŠŸç‡, è€—æ—¶, é”™è¯¯æ•°), åªå¯¹è¯·æ±‚é‡åšäº†è®¡ç®—, ä½†å…¶å®å¯ä»¥åŒæ—¶å¯¹äº”ä¸ªç‰¹å¾çš„æ•°æ®é›†åšå¼‚å¸¸æ£€æµ‹. 
2. å‘é‡è®¡ç®—: ä¾‹å¦‚æ–‡ä¸­æç¤º, åœ¨è®¡ç®— f1 score çš„è¿‡ç¨‹ä¸­, å°½å¯èƒ½ä½¿ç”¨å‘é‡è®¡ç®—, è€Œä¸æ˜¯ for å¾ªåŒ–: `fp = sum((cvPredictions == 1) & (yval == 0))`. 
3. éªŒè¯äº†å¼‚å¸¸æ£€æµ‹ç¡®å®éœ€è¦ç”¨ precision, recall & f1 score æ¥è¡¡é‡, ä¸Š  [Information Retrieval](/blog/20160731/comp6714-information-retrieval-and-web-search-2016s2/) çš„æ—¶å€™å­¦åˆ°çš„çŸ¥è¯†, å¹¶æ­£ç¡®åœ¨å·¥ä½œä¸­æ­£ç¡®åº”ç”¨å®è·µ, ç»™è‡ªå·±ç‚¹ä¸ªèµ ğŸ‘ 



